
<script src=""></script>

<div id="title">

  <main>
    <h2>Untracked</h2>
    <p>–ü—Ä–æ–µ–∫—Ç –¥–ª—è —Å–±–æ—Ä–∞ —Å–≤–µ–¥–µ–Ω–∏–π –æ –º–µ—Å—Ç–∞—Ö –æ—Ç–¥—ã—Ö–∞ –¥–∏–∫–æ–≥–æ —Ç—É—Ä–∏–∑–º–∞ –Ω–∞ –ë–∞–π–∫–∞–ª–µ</p>

    <a class="link" href="#join">–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è</a>
    <a class="link" href="#about">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</a>
  </main>

</div>

<div id="join" class="slide">

  <main>
    <h2>–í—ã–±–µ—Ä–∏—Ç–µ –º–µ—Å—Ç–æ –Ω–∞ –∫–∞—Ä—Ç–µ –∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ —Å–≤–æ—ë</h2>
    
    <div id="map"></div>

    <button id="to-join" class="but">–î–∞–ª—å—à–µ</button>
  </main>

</div>

<div id="setname" class="slide">

  <main>
    <h2>–î–∞–π—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ</h2>
    <input id="place-name" placeholder="–ó–∞–ø–∏—à–∏—Ç–µ —Å—é–¥–∞" />

    <button id="to-comment" class="but">–°–æ–∑–¥–∞—Ç—å</button>


  </main>

</div>

<div id="comment" class="slide">

  <main>
    <h2>–ü–æ–¥–µ–ª–∏—Ç–µ—Å—å —Å–≤–æ–∏–º–∏ –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏—è–º–∏</h2>
    <textarea id="text-comment" placeholder="–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –Ω–∞–º –±–æ–ª—å—à–µ –æ–± —ç—Ç–æ–º –º–µ—Å—Ç–µ" required></textarea>

    <div class="reactions">

      <input id=like type='radio' name='reaction'>
      <label class="react" for="like">üî•</label>
      <input id=norm type='radio' name='reaction'>
      <label class="react" for="norm">üòê</label>
      <input id=fu type='radio' name='reaction'>
      <label class="react" for="fu">üíÄ</label>

    </div>

    <button id="to-photos" class="but">–î–∞–ª—å—à–µ</button>


  </main>

</div>

<div id="photos" class="slide">

  <main>
    <h2>–ü—Ä–∏–∫—Ä–µ–ø–∏—Ç–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏</h2>
    <p>–ü–æ –∂–µ–ª–∞–Ω–∏—é</p>
    
    <label class="custom-upload">
        <input type="file" id="photoUpload" multiple accept="image/*" />
        <span>Upload photo</span>
    </label>

    <button id="to-send" class="but">–ó–∞–∫–æ–Ω—á–∏–º?</button>


  </main>

</div>

<div id="send" class="slide">

  <main>
    <h2 align="center">–í—Å—ë? –î–∞, —ç—Ç–æ —Ç–∞–∫!</h2>

    <button id="submit" class="but">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>

  </main>

</div>

<div id="about">

  <main>
    <h2>–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è</h2>
    <p>–ù–∞–¥ –ø—Ä–æ–µ–∫—Ç–æ–º `Untracked` —Ä–∞–±–æ—Ç–∞—é—Ç —Å—Ç—É–¥–µ–Ω—Ç—ã</p>

    <span class="select-but">
      <a class="link" href="#title">–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é</a>
    </span>

  </main>

</div>

<style>
  @import url('https://fonts.googleapis.com/css2?family=Jost:ital,wght@0,100..900;1,100..900&display=swap');
</style>

<style>


     :root
      {
        --txt-color: #f0f0f0;
        --bgcolor: #100f0f;
      }

      *:not(ymaps)
      {
        font-family: 'Jost';
        color: var(--txt-color);
        background-color: var(--bgcolor);
      }

::selection
{
  color: var(--bgcolor);
  background-color: var(--txt-color);
}

#place-name
{
  font-size: 20px;
  border: none;
  padding: 10px;
  width: 100%;
}

#map
{
  width: 640px;
  height: 480px;
}

html, body, body > div 
{
  width: 100% !important;
  height: 100% !important;
  margin: 0 !important;
  padding: 0 !important;
}

body
{
  display: flex;
  flex-direction: column;
  align-items: center;
}

.custom-upload > input[id="photoUpload"]
{
  display: none;
}

.custom-upload
{
  background: var(--bgcolor);
  font-size: 18px;
  padding: 10px;
  margin: 20px 10px;
  width: 100%;
  border: 1px dashed var(--txt-color);
  opacity: 80%;
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100px;
}

.custom-upload:hover
{
  cursor: pointer;
}


html {
scroll-behavior:smooth !important;
overflow-y:hidden !important;
}

.slide, #about, #title
{
  min-height: 100% !important;
  max-height: 100% !important;
  min-width: 500px !important;
  max-width: 500px !important;
  display: flex !important;
  justify-content: center !important;
  align-items: center !important;
}

input[type="radio"]
{
  display: none;
}

.react
{
  font-size: 25px;
  margin: 0 15px;
  padding: 8px;
  transition: border 0.3 ease;
  border: 1px solid transparent;
}

.react:hover
{
  cursor: pointer;
}

input[type="radio"]:checked + label
{
  border: 2px solid var(--txt-color);
}

main
{
  display: flex;
  width: 100%;
  flex-direction: column;
  align-items: center;
}


.but
{
  border: 2px solid var(--txt-color);
  font-size: 18px;
  border-radius: 5px;
  width: 204px;
  height: 44px;
  margin-top: 20px;
  padding: 0;
  transition: background-color 0.5s ease, color 0.5s ease;
}

.but:hover
{
  cursor: pointer;
  background-color: var(--txt-color);
  color: var(--bgcolor);
}

.link {
  width: 200px;
  height: 40px;
  border-radius: 5px;
  border: 2px solid var(--txt-color);
  text-decoration: none;
  display: flex;
  margin-top: 10px;
  justify-content: center;
  align-items: center;
  transition: background-color 0.5s ease, color 0.5s ease;
} 

.link:hover
{
  color: var(--bgcolor);
  background-color: var(--txt-color);
}

h2, p
{
  width: 100%;
}

#comment > main > textarea[id="text-comment"]
{
  font-size: 20px;
  border: none;
  padding: 10px;
  height: 200px;
  resize: none;
  width: 100%;
  margin-bottom: 20px;
}

span > a:hover
{
  color: var(--bgcolor);

  background-color: var(--txt-color);
}


</style>

<script>

    document.querySelector(".custom-upload input").addEventListener(
    "change", function(e)
    {
      const fileName = e.target.files.length ? `Upload ${e.target.files.length} files` : "Upload photo";
      this.parentElement.querySelector('span').textContent = fileName;
    }
  );

</script>

<script>
ymaps.ready(init);

let coords = null;
let targetCoords = null;
let placeGlobal = null;
let [place_name, comment, acoords, place_type, cost] = Array(5).fill(null);
let [reaction, photos] = Array(2).fill(null);

function init() {
  const map = new ymaps.Map("map", {
    center: [53.405327, 107.673049],
    zoom: 6
  });

  google.script.run
    .withSuccessHandler(function(data) {
      for (let place of data) {
        coords = [place[1], place[2]];
        const placemark = new ymaps.Placemark([place[1], place[2]], {
          balloonContent: place[0],
          hintContent: place[0],
        }, {
          preset: 'islands#redDotIcon',
          draggable: false
        });
        
        placemark.events.add('click', function(e) {
          if (placeGlobal) {
            map.geoObjects.remove(placeGlobal);
          }
          targetCoords = e.get('target').geometry.getCoordinates();
          place_name = place[0];
          coords = null;
        });
        
        map.geoObjects.add(placemark);
      }
    })
    .getList();
  map.events.add('click', function(e) {
    map.balloon.close();
    targetCoords = null;
    if (placeGlobal) {
      map.geoObjects.remove(placeGlobal);
    }
    coords = e.get('coords');
    placeGlobal = new ymaps.Placemark(coords, {
      balloonContent: 'Where',
      hintContent: 'Where',
    }, {
      preset: 'islands#redDotIcon',
      draggable: false
    });
    map.geoObjects.add(placeGlobal);
  });
}

document.getElementById("to-join").addEventListener(
  "click", function(e)
  {
    if (coords != null && targetCoords == null) 
    {
      window.location.hash = "#setname";
      acoords = coords;
    } 
    else if (targetCoords != null && coords == null)
    {
      window.location.hash = "#comment";
      acoords = targetCoords;
      alert(place_name);
    }
    else if(targetCoords == null && coords == null)
    {
      alert("–¢–æ—á–∫–∞ –Ω–µ –≤—ã–±—Ä–∞–Ω–∞. –í—ã–±–µ—Ä–∏—Ç–µ —Ç–æ—á–∫—É –Ω–∞ –∫–∞—Ä—Ç–µ.");
      return;
    }

  }

);

  document.getElementById("to-comment").addEventListener("click", function(e){
    place_name = document.getElementById("place-name").value.trim();
    if(place_name)
      window.location.hash = "#comment";
    else
    {
      alert("–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –º–µ—Å—Ç–∞!");
      return;
    }
  });

  document.getElementById("to-photos").addEventListener("click", function(e){
    comment = document.getElementById("text-comment").value.trim();
    reaction = document.querySelector("input[name='reaction']:checked");
    reaction = reaction ? reaction.id : null
    
    if(comment)
      window.location.hash = "#photos";
    else
    {
      alert("–í–≤–µ–¥–∏—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π!");
      return;
    }
  });
</script>
